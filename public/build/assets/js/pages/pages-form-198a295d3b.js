$(document).ready(function(){$.each($(".wysiwyg"),function(){$(this).attr("data-id");$(this).trumbowyg({fullscreenable:!1})}),$("#slug").on("keyup",function(t){var e=$(this).val(),a=$(this).attr("data-check-action"),n=$('meta[name="page_id"]').attr("content"),o=$(this);$.get("/"+a+"/"+n+"/"+e).done(function(t){if(t.status){$(o).closest(".form-group").addClass("has-error"),$(o).attr("data-error",!0);var e=$(o).closest(".form-group").find(".help-block");$(e).find("a").attr("href","/admin/pages/"+t.page.id),$(e).find("a").text(t.page.name),$(e).removeClass("hidden")}else{$(o).closest(".form-group").removeClass("has-error"),$(o).attr("data-error",!1);var e=$(o).closest(".form-group").find(".help-block");$(e).addClass("hidden"),$(e).find("a").attr("href",""),$(e).find("a").text("")}})}),$(".submit-button").on("click",function(t){function e(t){var e="."+t+"-content-types";$.each($(e+" .content-type"),function(t,e){$(e).attr("data-orderby",t)}),$.each($(e+" .content-type-field"),function(){var e=$(this).attr("data-contentType"),a="",n=$(this).attr("data-name");$(this).attr("data-id");if(a=$(this).hasClass("wysiwyg")?$(this).trumbowyg("html"):$(this).val(),a.length>0){var o=$(this).closest(".content-type").attr("data-orderby"),i='<input type="hidden" name="'+t+"["+o+"]["+e+"]["+n+']" value="'+a+'" class="contentType" data-location="'+t+'">';$("form#submitForm").append(i)}})}if($('input[data-error="true"]').length>0)return t.preventDefault(),null;""==$("#submitForm").attr("action")&&$("#submitForm").attr("action",$(this).attr("data-action")),$.each($(".input-fields input"),function(){var t='<input type="hidden" name="'+$(this).attr("name")+'" value="'+$(this).val()+'">';$("form#submitForm").append(t)}),e("head"),e("body"),e("foot");var a=$(this).attr("data-method"),n='<input type="hidden" name="_method" value="'+a+'">';$("#submitForm").append($(n)),$("#submitForm").submit()}),$(".content-type-select").on("click",function(t){var e=$(this).attr("data-href"),a=$(this).attr("data-location");$.get(e,function(t){var e="."+a+"-content-types";$(e).append($(t.html)),componentHandler.upgradeDom()}),t.preventDefault()}),$(".content-types").on("click",".remove-content-type-btn",function(t){t.preventDefault();var e=$(this).attr("data-id"),a=$(this).closest(".content-types").attr("data-location"),n=$("."+a+"-content-types").find('[data-id="'+e+'"]');$(n).remove()}),$(".content-types").on("click",".move-content-type-btn",function(t){t.preventDefault();var e=$(this).attr("data-id"),a=$(this).attr("data-direction");$(this).closest(".content-types").attr("data-location");if("up"==a){var n=$('.content-type.group[data-id="'+e+'"]'),o=$(n).prev($(".content-type.group"));$(n).insertBefore(o),$(this).addClass("btn-success"),setTimeout(function(){$(n).find(".move-content-type-btn").removeClass("btn-success")},200)}else if("down"==a){var n=$('.content-type.group[data-id="'+e+'"]'),i=$(n).next($(".content-type.group"));$(n).insertAfter($(i)),$(this).addClass("btn-success"),setTimeout(function(){$(n).find(".move-content-type-btn").removeClass("btn-success")},200)}})});